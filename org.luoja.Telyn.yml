app-id: org.luoja.Telyn
runtime: org.gnome.Platform
runtime-version: '3.38'
sdk: org.gnome.Sdk
command: TelynGtk
cleanup:
  - swift-5.5-RELEASE-ubuntu20.04
finish-args:
  - --share=ipc
  - --socket=x11
  - --socket=wayland
  - --filesystem=xdg-documents
  - --filesystem=xdg-download
modules:
  - name: swift-lib
    buildsystem: simple
    sources:
      - type: file
        url: https://swift.org/builds/swift-5.5-release/ubuntu2004/swift-5.5-RELEASE/swift-5.5-RELEASE-ubuntu20.04.tar.gz
        sha256: aaf7eaefdc3f90f77b21b8829546fc2648e02928af476437d6a58556cb858ec6
    build-commands:
      - tar -xzf swift-5.5-RELEASE-ubuntu20.04.tar.gz
      - mkdir -p /app/lib
      # Place the shared object files directly in /app/lib
      - cp -r swift-5.5-RELEASE-ubuntu20.04/usr/lib/swift/linux/* /app/lib
  - name: telyngtk
    buildsystem: simple
    sources:
      - type: archive
        url: https://gitlab.com/t2056/telyngtk/-/jobs/1639790825/artifacts/raw/TelynGtk-Release.tar.gz
        sha256: a26ddbad02bfb4f17da6fddac1eba4c35122bed148b83b567a9bdf4956c3f0aa
    build-commands:
      - ls
      - mkdir /app/bin
      - cp TelynGtk /app/bin/
      - cp -r *.resources /app/bin/
  - name: share
    buildsystem: simple
    sources:
      - type: file
        path: org.luoja.Telyn.desktop
      - type: file
        path: org.luoja.Telyn.svg
      - type: file
        path: org.luoja.Telyn-symbolic.svg
      - type: file
        path: org.luoja.Telyn.appdata.xml
    build-commands:
      - install -D org.luoja.Telyn.desktop /app/share/applications/org.luoja.Telyn.desktop
      - install -D org.luoja.Telyn.svg /app/share/icons/hicolor/scalable/apps/org.luoja.Telyn.svg
      - install -D org.luoja.Telyn-symbolic.svg /app/share/icons/hicolor/scalable/apps/org.luoja.Telyn-symbolic.svg
      - appstream-util validate-relax org.luoja.Telyn.appdata.xml
      - install -D org.luoja.Telyn.appdata.xml /app/share/metainfo/org.luoja.Telyn.appdata.xml
      
